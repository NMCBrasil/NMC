<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Gerador de Carimbo</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 750px;
      margin: 20px auto;
      padding: 0 15px;
    }
    label {
      font-weight: bold;
      display: block;
      margin-top: 12px;
    }
    input[type="text"],
    input[type="datetime-local"],
    textarea,
    select {
      width: 100%;
      box-sizing: border-box;
      font-size: 14px;
      padding: 6px;
      margin-top: 5px;
    }
    textarea {
      min-height: 60px;
      resize: vertical;
    }
    button {
      margin-top: 15px;
      padding: 10px 15px;
      font-size: 16px;
      cursor: pointer;
    }
    #carimbo {
      white-space: pre-line;
      margin-top: 20px;
      border: 1px solid #ccc;
      padding: 15px;
      background-color: #f9f9f9;
      font-family: monospace;
      font-size: 14px;
      line-height: 1.15;
    }
    .msg {
      position: fixed;
      bottom: 10px;
      right: 10px;
      background: #28a745;
      color: white;
      padding: 8px 12px;
      border-radius: 5px;
      font-weight: bold;
      font-size: 14px;
    }
  </style>
</head>
<body>

<h2>Gerador de Carimbo</h2>

<label for="tipoCarimbo">Tipo de Carimbo:</label>
<select id="tipoCarimbo" onchange="alternarFormulario()">
  <option value="abertura">Abertura</option>
  <option value="encerramento">Encerramento</option>
</select>

<!-- Formulário de Abertura -->
<div id="formAbertura">
  <label>Data e Hora do Início da Falha:</label>
  <input type="datetime-local" id="dataHoraInicio" />

  <label>Tecnologia:</label>
  <select id="tecnologia">
    <option value="">(não informado)</option>
    <option>Manaus Banda C</option>
    <option>Manaus SCPC</option>
    <option>HN</option>
    <option>HN2</option>
    <option>HX</option>
    <option>Jup Banda C</option>
    <option>Jup Banda KU</option>
    <option>OneWeb</option>
    <option>BGANs</option>
    <option>Frotas</option>
    <option>HughesON</option>
    <option>LTE</option>
  </select>

  <label>Cliente(s) Afetado(s):</label>
  <input type="text" id="clientesAfetados" />

  <label>Descrição do(s) Alarme(s):</label>
  <textarea id="descricaoAlarmes"></textarea>

  <label>Descrição do(s) Equipamento(s):</label>
  <textarea id="descricaoEquipamentos"></textarea>

  <label>Link do Diagrama de Rede:</label>
  <input type="text" id="linkDiagrama" />

  <label>Ferramentas Utilizadas no Troubleshooting:</label>
  <textarea id="ferramentasTroubleshooting"></textarea>

  <label>Testes Realizados pelo NMC:</label>
  <textarea id="testesNMC"></textarea>
</div>

<!-- Formulário de Encerramento -->
<div id="formEncerramento" style="display:none;">
  <label>Data e Hora da Solução:</label>
  <input type="datetime-local" id="dataHoraSolucao" />

  <label>Cliente(s) Atendido(s):</label>
  <input type="text" id="clientesAtendidos" />

  <label>Ações Realizadas pelo NMC:</label>
  <textarea id="acoesNMC"></textarea>

  <label>Anexos de Logs (opcional):</label>
  <input type="text" id="anexosLogs" />
</div>

<button onclick="gerarCarimbo()">Gerar Carimbo</button>
<button onclick="copiarCarimbo()">Copiar Carimbo</button>

<div id="carimbo"></div>

<script>
function pad(valor) {
  return valor.trim() !== '' ? valor.trim() : '(não informado)';
}

function formatarDataHora(valor) {
  if (!valor) return '(não informado)';
  const dt = new Date(valor);
  if (isNaN(dt)) return '(não informado)';
  return dt.toLocaleString('pt-BR', {
    day: '2-digit', month: '2-digit', year: 'numeric',
    hour: '2-digit', minute: '2-digit', second: '2-digit'
  });
}

function alternarFormulario() {
  const tipo = document.getElementById('tipoCarimbo').value;
  document.getElementById('formAbertura').style.display = tipo === 'abertura' ? 'block' : 'none';
  document.getElementById('formEncerramento').style.display = tipo === 'encerramento' ? 'block' : 'none';
  document.getElementById('carimbo').textContent = '';
}

function gerarCarimbo() {
  const tipo = document.getElementById('tipoCarimbo').value;
  let texto = '';

  if (tipo === 'abertura') {
    const inicio = formatarDataHora(document.getElementById('dataHoraInicio').value);
    const tecnologia = pad(document.getElementById('tecnologia').value);
    const clientes = pad(document.getElementById('clientesAfetados').value);
    const alarmes = pad(document.getElementById('descricaoAlarmes').value);
    const equipamentos = pad(document.getElementById('descricaoEquipamentos').value);
    const diagrama = document.getElementById('linkDiagrama').value.trim();
    const ferramentas = pad(document.getElementById('ferramentasTroubleshooting').value);
    const testes = pad(document.getElementById('testesNMC').value);

    texto += `Data e Hora do Início da Falha: ${inicio}\r\n`;
    texto += `Tecnologia: ${tecnologia}\r\n`;
    texto += `Cliente(s) Afetado(s): ${clientes}\r\n`;
    texto += `Descrição do(s) Alarme(s): ${alarmes}\r\n`;
    texto += `Descrição do(s) Equipamento(s): ${equipamentos}\r\n`;
    if (diagrama !== '') texto += `Link do Diagrama de Rede: ${diagrama}\r\n`;
    texto += `Ferramentas Utilizadas no Troubleshooting: ${ferramentas}\r\n`;
    texto += `Testes Realizados pelo NMC: ${testes}`;

  } else if (tipo === 'encerramento') {
    const solucao = formatarDataHora(document.getElementById('dataHoraSolucao').value);
    const clientes = pad(document.getElementById('clientesAtendidos').value);
    const acoes = pad(document.getElementById('acoesNMC').value);
    const anexos = document.getElementById('anexosLogs').value.trim();

    texto += `Data e Hora da Solução: ${solucao}\r\n`;
    texto += `Cliente(s) Atendido(s): ${clientes}\r\n`;
    texto += `Ações Realizadas pelo NMC: ${acoes}`;
    if (anexos !== '') texto += `\r\nAnexos de Logs: ${anexos}`;
  }

  document.getElementById('carimbo').textContent = texto;
}

function copiarCarimbo() {
  const carimbo = document.getElementById('carimbo').textContent;
  if (!carimbo) return;
  navigator.clipboard.writeText(carimbo).then(() => {
    const msg = document.createElement('div');
    msg.textContent = 'Carimbo copiado para a área de transferência.';
    msg.className = 'msg';
    document.body.appendChild(msg);
    setTimeout(() => msg.remove(), 2500);
  });
}
</script>

</body>
</html>
